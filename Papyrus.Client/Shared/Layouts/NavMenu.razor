@using Papyrus.Client.Services.Auth.Interfaces
@inject IAuthService authService
@inject IStringLocalizer<NavMenu> L

<MainImage Width="180" Class="d-flex align-items-center justify-content-center" />
<MudDivider />
<MudNavMenu Dense="true" Color="Color.Secondary" Margin="Margin.Dense" Rounded="true" Class="pa-2">
    <AuthorizeView>
        <Authorized>
            @if (GroupMenuItems.Count > 0)
            {
                <MudText Typo="Typo.h6" Class="text-center" Color="Color.Secondary">@L["GroupTitle"]</MudText>
                if (!string.IsNullOrEmpty(GroupTitle))
                {
                    <MudText Typo="Typo.subtitle2" Class="text-center" Color="Color.Secondary">@GroupTitle</MudText>
                }
                <TreeMenu Items="GroupMenuItems" Localizer="L" />
                <MudDivider Class="my-2" />
            }
            <MudText Typo="Typo.h6" Class="text-center" Color="Color.Secondary">@L["MainTitle"]</MudText>
            <TreeMenu Items="MenuItems" Localizer="L" />
            <MudDivider Class="my-2" />
            <MudNavLink Icon="@Icons.Filled.Logout" OnClick="ToLogout" IconColor="Color.Error">@L["LogOut"]</MudNavLink>
        </Authorized>
    </AuthorizeView>
</MudNavMenu>

@code
{
    [Parameter, EditorRequired]
    public List<MenuItem> MenuItems { get; set; } = new();

    [Parameter]
    public List<MenuItem> GroupMenuItems { get; set; } = new();

    [Parameter]
    public string GroupTitle { get; set; } = "";

    private void ToLogout()
    {
        authService.Logout();
    }
}
