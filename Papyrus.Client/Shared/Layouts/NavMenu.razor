@using Papyrus.Client.Services.Interfaces
@using Papyrus.Client.Services.Auth.Interfaces
@using static Papyrus.Client.Shared.PapyrusMenu
@inject IAuthService authService

<div>
    <img src="assets/images/main.svg" width="240" alt="Page image" />
</div>
<MudDivider />
<MudNavMenu Dense="true" Color="Color.Secondary" Margin="Margin.Dense" Rounded="true" Class="pa-2">
    <AuthorizeView>
        <Authorized>
            @if (GroupMenuItems.Count > 0)
            {
                <MudText Typo="Typo.h6" Class="text-center" Color="Color.Secondary">Group Menu</MudText>
                if (!string.IsNullOrEmpty(GroupTitle))
                {
                    <MudText Typo="Typo.subtitle2" Class="text-center" Color="Color.Secondary">@GroupTitle</MudText>
                }
                <TreeMenu Items="GroupMenuItems" />
                <MudDivider Class="my-2" />
            }
            <MudText Typo="Typo.h6" Class="text-center" Color="Color.Secondary">Menu</MudText>
            <TreeMenu Items="MenuItems" />
            <MudDivider Class="my-2" />
            <MudNavLink Icon="@Icons.Filled.Logout" OnClick="ToLogout" IconColor="Color.Error">Log Out</MudNavLink>
        </Authorized>
    </AuthorizeView>
</MudNavMenu>

@code
{
    [Parameter, EditorRequired]
    public List<MenuItem> MenuItems { get; set; } = new();

    [Parameter]
    public List<MenuItem> GroupMenuItems { get; set; } = new();

    [Parameter]
    public string GroupTitle { get; set; } = "";

    private void ToLogout()
    {
        authService.Logout();
    }
}
