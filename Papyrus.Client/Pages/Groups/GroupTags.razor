@page "/groups/{GroupId:int}/tags"
@attribute [Authorize]

<GroupPageTitle PageName="Tags" />

<div class="page-div">
    @if (Rights.CanCreate)
    {
        <ActionBar>
            <MudButton Color="Color.Secondary" Variant="Variant.Filled" OnClick="() => Create(null)">Create</MudButton>
        </ActionBar>
    }
    <MudCard Elevation="2">
        <MudTreeView Items="TreeItems">
            <ItemTemplate>
                <MudTreeViewItem @bind-Expanded="context.IsExpanded" Items="context.Items">
                    <Content>
                        <MudTreeViewItemToggleButton @bind-Expanded="context.IsExpanded" Visible="context.HasChild" />
                        <div class="flex-box flex-row align-items-center">
                            <MudText Class="mr-1">@context.Data.Caption</MudText>
                            <div style="@("background-color:" + context.Data.Color)" class="color-box"></div>
                            @if (Rights.CanCreate)
                            {
                                <MudIconButton Icon="@Icons.Filled.Add" Variant="Variant.Text" Size="Size.Small" OnClick="() => Create(context.Data.Id)" />
                            }
                            <MudSpacer />
                            @if (!context.HasChild && Rights.CanRemove)
                            {
                                <MudIconButton Color="Color.Error" Icon="@Icons.Filled.Remove" Variant="Variant.Text" Size="Size.Small" OnClick="() => Remove(context.Data.Id)" />
                            }
                            @if (Rights.CanEdit)
                            {
                                <MudIconButton Color="Color.Warning" Icon="@Icons.Filled.Edit" Variant="Variant.Text" Size="Size.Small" OnClick="() => Edit(context.Data.Id)" />
                            }
                        </div>
                    </Content>
                </MudTreeViewItem>
            </ItemTemplate>
        </MudTreeView>
    </MudCard>
</div>